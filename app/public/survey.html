<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Survey Page</title>

  <!-- Latest compiled and minified CSS & JS -->
  <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script> -->

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

</head>
<body>

  <div class="container">

    <div class="row">
      <div class="col-lg-12">

        <div>
            <h2>Survey Questions</h2>
        </div>

        <hr>

        <div>
            <h3>About You</h3>
        </div>


        <form role="form">

            <div class="form-group">
                <label for="name"><h4>Name (Required)</h4></label>
                <input type="text" class="form-control" id="name">
            </div>
            <div class="form-group">
                <label for="photo"><h4>Link to Photo Image (Required)</h4></label>
                <input type="text" class="form-control" id="photo">
            </div>

            <hr>

            <div class="form-group">
                <label for="sel1">                    
                    <h3>Question 1</h3>
                    <h4>You believe in destiny.</h4>
                </label>
                <div class="row">
                    <div class="col-md-2">  
                        <select class="form-control" id="q1">
                            <option value="" selected disabled>Select an Option</option>
                            <option value=5>Strongly Agree</option>
                            <option value=4>Agree</option>
                            <option value=3>Neutral</option>
                            <option value=2>Disagree</option>
                            <option value=1>Strongly Disagree</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="sel1">                    
                    <h3>Question 2</h3>
                    <h4>You prefer quality friendships over quantity.</h4>
                </label>
                <div class="row">
                    <div class="col-md-2">  
                        <select class="form-control" id="q2">
                            <option value="" selected disabled>Select an Option</option>
                            <option value=5>Strongly Agree</option>
                            <option value=4>Agree</option>
                            <option value=3>Neutral</option>
                            <option value=2>Disagree</option>
                            <option value=1>Strongly Disagree</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="sel1">                    
                    <h3>Question 3</h3>
                    <h4>You are family-oriented.</h4>
                </label>
                <div class="row">
                    <div class="col-md-2">  
                        <select class="form-control" id="q3">
                            <option value="" selected disabled>Select an Option</option>
                            <option value=5>Strongly Agree</option>
                            <option value=4>Agree</option>
                            <option value=3>Neutral</option>
                            <option value=2>Disagree</option>
                            <option value=1>Strongly Disagree</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="sel1">                    
                    <h3>Question 4</h3>
                    <h4>You have a religious affiliation.</h4>
                </label>
                <div class="row">
                    <div class="col-md-2">  
                        <select class="form-control" id="q4">
                            <option value="" selected disabled>Select an Option</option>
                            <option value=5>Strongly Agree</option>
                            <option value=4>Agree</option>
                            <option value=3>Neutral</option>
                            <option value=2>Disagree</option>
                            <option value=1>Strongly Disagree</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="sel1">                    
                    <h3>Question 5</h3>
                    <h4>You love new experiences and learning new things.</h4>
                </label>
                <div class="row">
                    <div class="col-md-2">  
                        <select class="form-control" id="q5">
                            <option value="" selected disabled>Select an Option</option>
                            <option value=5>Strongly Agree</option>
                            <option value=4>Agree</option>
                            <option value=3>Neutral</option>
                            <option value=2>Disagree</option>
                            <option value=1>Strongly Disagree</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="sel1">                    
                    <h3>Question 6</h3>
                    <h4>You are always looking for ways to better yourself.</h4>
                </label>
                <div class="row">
                    <div class="col-md-2">  
                        <select class="form-control" id="q6">
                            <option value="" selected disabled>Select an Option</option>
                            <option value=5>Strongly Agree</option>
                            <option value=4>Agree</option>
                            <option value=3>Neutral</option>
                            <option value=2>Disagree</option>
                            <option value=1>Strongly Disagree</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="sel1">                    
                    <h3>Question 7</h3>
                    <h4>You need to get your work done before you can relax.</h4>
                </label>
                <div class="row">
                    <div class="col-md-2">  
                        <select class="form-control" id="q7">
                            <option value="" selected disabled>Select an Option</option>
                            <option value=5>Strongly Agree</option>
                            <option value=4>Agree</option>
                            <option value=3>Neutral</option>
                            <option value=2>Disagree</option>
                            <option value=1>Strongly Disagree</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="sel1">                    
                    <h3>Question 8</h3>
                    <h4>You enjoy going to festivals and events.</h4>
                </label>
                <div class="row">
                    <div class="col-md-2">  
                        <select class="form-control" id="q8">
                            <option value="" selected disabled>Select an Option</option>
                            <option value=5>Strongly Agree</option>
                            <option value=4>Agree</option>
                            <option value=3>Neutral</option>
                            <option value=2>Disagree</option>
                            <option value=1>Strongly Disagree</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="sel1">                    
                    <h3>Question 9</h3>
                    <h4>You enjoy the company of a pet.</h4>
                </label>
                <div class="row">
                    <div class="col-md-2">  
                        <select class="form-control" id="q9">
                            <option value="" selected disabled>Select an Option</option>
                            <option value=5>Strongly Agree</option>
                            <option value=4>Agree</option>
                            <option value=3>Neutral</option>
                            <option value=2>Disagree</option>
                            <option value=1>Strongly Disagree</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="sel1">                    
                    <h3>Question 10</h3>
                    <h4>You have an interest in vegetarianism or veganism.</h4>
                </label>
                <div class="row">
                    <div class="col-md-2">  
                        <select class="form-control" id="q10">
                            <option value="" selected disabled>Select an Option</option>
                            <option value=5>Strongly Agree</option>
                            <option value=4>Agree</option>
                            <option value=3>Neutral</option>
                            <option value=2>Disagree</option>
                            <option value=1>Strongly Disagree</option>
                        </select>
                    </div>
                </div>
            </div>

            <button type="submit" class="btn btn-primary submit" id="submit-btn">Submit</button>

        </form>



      </div>
    </div>

  </div>

</body>
</html>

<!-- BELOW CODE IS CRITICAL. IT HANDLES HOW FORM DATA IS SENT TO OUR SERVER -->
<script type="text/javascript">

    $(".dropdown-menu li a").click(function(){
        $(this).parents(".dropdown").find('.btn').html($(this).text() + ' <span class="caret"></span>');
        $(this).parents(".dropdown").find('.btn').val($(this).data('value'));
    });

    function updateManufacturerIdSelect(val) {
        console.log('updateManufacturerIdSelect: ' + val);
    }

    $(".dropdown-menu li a").click(function () {
        var selText = $(this).text();
        $(this).closest('.btn-group').find('.btn').html(selText + ' <span class="caret"></span>');
        updateManufacturerIdSelect($(this).closest('li').data('value'));
    });

// https://stackoverflow.com/questions/43294807/reset-bootstrap-dropdown-button-value-on-click?utm_medium=organic&utm_source=google_rich_qa&utm_campaign=google_rich_qa
    // $('.dropdown-menu li').on('click', function(e) {
    //     $('.dropdown-toggle').contents().filter(function(idx, ele) {
    //         return ele.nodeType == Node.TEXT_NODE && ele.textContent.trim().length != 0
    //     }).get(0).textContent = ' ' + this.textContent.trim() + ' ';
    // });

    // $('#submit-btn').on('click', function(e) {
    //     if ($(this).attr('defValue') == undefined) {
    //         $(this).attr('defValue', ' ' + $('.dropdown-toggle').contents().get(2).textContent + ' ');
    //     } else {
    //         $('.dropdown-toggle').contents().get(2).textContent = ' ' + $(this).attr('defValue') + ' ';
    //     }
    // }).trigger('click');


    // In this code below we create the Front-end JavaScript which "POSTS" our form data to our express server.
    // In essence, when the user hits submit, jQuery grabs all of the fields then sends a post request to our api
    // Our api recognizes the route (/api/tables)... and then runs the associated code (found in api-routes.js).
    // In this case the associated code "saves" the data to the table-data.js file or waitinglist-data.js file

    $("#submit-btn").on("click", function(event) {
        event.preventDefault();

        // if ($(this).attr('defValue') == undefined) {
        //     $(this).attr('defValue', ' ' + $('.dropdown-toggle').contents().get(2).textContent + ' ');
        // } else {
        //     $('.dropdown-toggle').contents().get(2).textContent = ' ' + $(this).attr('defValue') + ' ';
        // }

        // Here we grab the form elements
        var newUser = {
            name: $('#name').val().trim(),
            photo: $('#photo').val().trim(),
            scores: 
                [ 
                    $('#q1').val(), 
                    $('#q2').val(), 
                    $('#q3').val(), 
                    $('#q4').val(), 
                    $('#q5').val(),
                    $('#q6').val(), 
                    $('#q7').val(), 
                    $('#q8').val(), 
                    $('#q9').val(), 
                    $('#q10').val()
                ]
        };

      console.log(newUser);

      // This line is the magic. It"s very similar to the standard ajax function we used.
      // Essentially we give it a URL, we give it the object we want to send, then we have a "callback".
      // The callback is the response of the server. In our case, we set up code in api-routes that "returns" true or false
      // depending on if a tables is available or not.

      $.post("/api/friends", newUser,
        function(data) {

        //   // If a table is available... tell user they are booked.
        //   if (data) {
        //     alert("Yay! You are officially booked!");
        //   }

        //   // If a table is available... tell user they on the waiting list.
        //   else {
        //     alert("Sorry you are on the wait list");
        //   }

        });

        // Clear the form when submitting
        $("#name").val("");
        $("#photo").val("");

    });

</script>
